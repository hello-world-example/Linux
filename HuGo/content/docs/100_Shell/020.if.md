---
title: "if 条件语句"
weight: 20
---



# 条件语句



## 语法结构

```bash
# 【注意 1】语句块内并不能为空
# 【注意 2】不要吝啬空格（与变量的定义不同，变量等号前后不能有空格）
if [ expr ]; then
  echo "if"
elif [ expr ]; then
  echo "elif"
else
  echo "else"
fi
```



## 速记

- `test expr` 和 `[ expr ]` 效果相同
  - 是 Shell 命令，通过 `whereis [` =》 `/bin/[`， `man [` 可查看命令帮助
  - 用于 **判断文件**、**判断字符串** ，支持 `==` 、`!=`
  - 判断**整数**时，使用 `-eq` 、 `-gt` 形式
  - 逻辑组合使用 `-a` 、 `-o` 
- `[[ expr ]]` 支持 **模式匹配**
  - `==` 精确匹配： `[[ hello == "hell?" ]]` 为 false 
  - `==` 模糊匹配： `[[ hello == hell? ]]` 为 true 
  - `=~` 正则匹配： `[[ hello =~ ^h.{4} ]]` 为 true 
  - 逻辑组合使用： `&&` 、 `||`  
  - 数字比较 `[[ 1 -lt 3 && 3 -eq 3 ]]` 、 `[[ 1 < 3 && 3 == 3 ]]` 为 true， 但是建议使用 `(( 1 < 3 && 3 == 3 ))`
- `let expr` 和 `(( expr ))` 用于**算术运算**，如： `(( 99 + 1 <= 101 ))`
  - 直接使用熟悉的 `<`、 `>` 等比较运算符
  - 直接使用变量名如：`var`，不需要 `$var` 这样的形式



## 对比

|              |       [ expr ]       |  [[ expr ]]  |  (( expr ))  |
| -----------: | :------------------: | :----------: | :----------: |
|              |    命令，`/bin/[`    |  语法关键字  |              |
| **主要用途** |       文件判断       |  字符串匹配、文件判断  |   算术运算   |
| **大小比较** | `==`、 `!=`、`-lt`、`-gt` | `==`、`=~` |`>=` 、 `==` |
| **逻辑运算** |     `-a` 、 `-o`     | `&&` 、 `||` | `&&` 、 `||` |
| **逻辑短路** | `false` | `true` |  |



## [ expr ] 、[[ expr ]]  文件判断

|     文件比较运算符      |   操作全称   | 描述                         |
| :---------------------: | :----------: | ---------------------------- |
|       -e filename       |   `exist`    | 文件存在                     |
|       -d filename       | `directory`  | 文件存在 && 是目录           |
|       -f filename       |    `file`    | 文件存在 && 是常规文件       |
|       -s filename       |    `size`    | 文件存在 && 大小不为 0       |
|       -L filename       |    `link`    | 文件存在 && 是符号链接       |
|       -r filename       |  `readable`  | 文件存在 && 可读             |
|       -w filename       |  `writable`  | 文件存在 && 可写             |
|       -x filename       | `executable` | 文件存在 && 可执行           |
| filename1 -nt filename2 |  `new that`  | filename1 比 filename2 新    |
| filename1 -ot filename2 |  `old that`  | filename1 比 filename2 旧    |
|       -c filename       |    `char`    | 文件存在 && 是字符型特殊文件 |
|       -d filename       |   `block`    | 文件存在 && 是块特殊文件     |



## [[ expr ]]  字符串判断

|        表达式 | 描述              | 备注 |
| :-----------: | :-------------------- | ---- |
| `-z "${str}"` 或 `${#str} == 0` |  长度为 0       |   `zero`   |
| `-n "${str}"` 或 `${#str} > 0` | 长度不为 0 |  `not zero`    |
| `${str} == "string"` | 等值比较 |      |
| `"hello" == hell?` | **模糊匹配** | 模糊表达式不能加 双引号 |
| `"hello" != hi*` | **模糊不匹配** | |
| `"hello" =~ ^h.{4}` | **正则匹配** | |
| `"abc" < "b"` | ASCII 比较 | |


