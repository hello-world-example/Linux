---
title: var 字符串处理
weight: 011
---



# String 变量处理



## 速记

- 三个特殊符号在键盘上的位置 `#`  `$`  `%`
  - `$` 用来取值
  - `#` 在 `$` 的左边，**删除**字符串的**左边**的内容，需要配合 `*` ，如：`${str#*/}`
  - `##` 是贪婪匹配，从左往右，`#` 是匹配到第一个，`##` 是匹配到最后一个，如： `${str##*/}`
  - `%` 在 `$` 的右边，**删除**字符串的**右边**的内容，需要配合 `*` ，如：`${str%/*}`
  - `%%` 是贪婪匹配，从右往左，`%` 是匹配到倒数第一个，`%%` 是匹配到开头第一个，如： `${str%%/*}`
- **字符串替换**
  -  `${VALUE/OLD/NEW}`  替换第一个，如： `${str/\//.}`
  -  `${VALUE//OLD/NEW}`  替换所有，如： `${str//\//.}`
- **字符串截取**
  - `${VALUE:OFFSET:LENGTH}` 从**左**开始**向右**截取，如：`${str:1}` 、 `${str:1:2}`
  - `${VALUE:0-OFFSET:LENGTH}` 从**右**开始**向由**截取，如：`${str:0-1}` 、 `${str:0-3:2}`
- **变量默认值替换**
  - `${VALUE:-WORD}`：当变量**未定义**或者**值为空**时，返回值为 WORD 的内容，否则返回变量的值
  - `${VALUE:=WORD}`：当变量**未定义**或者**值为空**时，返回 WORD 的值的同时并将 WORD 赋值给 VALUE，否则返回变量的值
  - `${VALUE:+WORD}`：当变量 **已赋值** 时，其值才用 WORD 替换，否则不进行任何替换
  - `${VALUE:?MESSAGE}`：当变量已赋值时，正常替换。否则将消息 MESSAGE 送到标准错误输出，在SHELL程序中时将终止运行



## 示例

```bash
#!/bin/bash

str="123/465/789"

echo $str" == 123/465/789"
echo
echo "字符串长度"
echo ${#str}" == 11"
echo
echo "删除左侧"
echo ${str#*/}" == 456/789"
echo ${str##*/}" == 789"
echo
echo "删除右侧"
echo ${str%/*}" == 123/456"
echo ${str%%/*}" == 123"
echo
echo "字符串替换"
echo ${str/\//.}" == 123.456/789"
echo ${str//\//.}" == 123.456.789"
echo
echo "字符串截取"
echo ${str:1}" == 23/465/789"
echo ${str:1:2}" == 23"
echo ${str:0-1}" == 9"
echo ${str:0-3:2}" == 78"
echo
echo "变量默认值"
str=''
echo ${str:-"123"}" == 123"
echo ${str}" == ''"
echo ${str:="345"}" == 345"
echo ${str}" == 345"

echo ${str:?"Error Message"}" == 345 -- 无错误信息"
str=''
echo ${str:?"Error Message"}" -- 这里报错"
```

